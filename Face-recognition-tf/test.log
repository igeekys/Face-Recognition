WARNING:tensorflow:
The TensorFlow contrib module will not be included in TensorFlow 2.0.
For more information, please see:
  * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md
  * https://github.com/tensorflow/addons
  * https://github.com/tensorflow/io (for I/O related ops)
If you depend on functionality not listed there, please file an issue.

Using TensorFlow backend.
WARNING:tensorflow:From main.py:62: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From main.py:62: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2021-04-22 02:20:50.785066: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2021-04-22 02:20:50.814425: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 1795785000 Hz
2021-04-22 02:20:50.816008: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x52e9610 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2021-04-22 02:20:50.816058: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2021-04-22 02:20:50.819504: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-04-22 02:20:50.975127: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x52ed380 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2021-04-22 02:20:50.975206: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): GeForce GTX 1080 Ti, Compute Capability 6.1
2021-04-22 02:20:50.977013: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1639] Found device 0 with properties: 
name: GeForce GTX 1080 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.645
pciBusID: 0000:04:00.0
2021-04-22 02:20:50.977545: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-22 02:20:50.996445: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-22 02:20:50.997650: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2021-04-22 02:20:51.006868: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2021-04-22 02:20:51.019492: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2021-04-22 02:20:51.021088: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2021-04-22 02:20:51.035291: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-04-22 02:20:51.036812: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1767] Adding visible gpu devices: 0
2021-04-22 02:20:51.036875: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2021-04-22 02:20:51.041828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1180] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-04-22 02:20:51.041865: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1186]      0 
2021-04-22 02:20:51.041881: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1199] 0:   N 
2021-04-22 02:20:51.043745: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1325] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 10489 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1080 Ti, pci bus id: 0000:04:00.0, compute capability: 6.1)
WARNING:tensorflow:From /home/mist/tf-code/ResNet/ResNet.py:96: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /mistgpu/site-packages/tf_slim/layers/layers.py:1089: Layer.apply (from tensorflow.python.keras.engine.base_layer) is deprecated and will be removed in a future version.
Instructions for updating:
Please use `layer.__call__` method instead.
WARNING:tensorflow:From /home/mist/tf-code/ResNet/ResNet.py:107: The name tf.variable_scope is deprecated. Please use tf.compat.v1.variable_scope instead.

WARNING:tensorflow:From /home/mist/tf-code/ResNet/ResNet.py:120: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From /home/mist/tf-code/ResNet/utils.py:19: The name tf.trainable_variables is deprecated. Please use tf.compat.v1.trainable_variables instead.

Loading 4 classes
loading training images...
finished loading 5943 training images
loading validate images...
finished loading 593 validation images
loading test images...
finished loading 893 test images
data preprocessing...
---------
Variables: name (type shape) [size]
---------
resnet_v1_50/conv1/weights:0 (float32_ref 7x7x3x64) [9408, bytes: 37632]
resnet_v1_50/conv1/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/conv1/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_1/bottleneck_v1/shortcut/weights:0 (float32_ref 1x1x64x256) [16384, bytes: 65536]
resnet_v1_50/block1/unit_1/bottleneck_v1/shortcut/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_1/bottleneck_v1/shortcut/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x64x64) [4096, bytes: 16384]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x64x64) [36864, bytes: 147456]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x64x256) [16384, bytes: 65536]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_1/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x256x64) [16384, bytes: 65536]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x64x64) [36864, bytes: 147456]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x64x256) [16384, bytes: 65536]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_2/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x256x64) [16384, bytes: 65536]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x64x64) [36864, bytes: 147456]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 64) [64, bytes: 256]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x64x256) [16384, bytes: 65536]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block1/unit_3/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block2/unit_1/bottleneck_v1/shortcut/weights:0 (float32_ref 1x1x256x512) [131072, bytes: 524288]
resnet_v1_50/block2/unit_1/bottleneck_v1/shortcut/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_1/bottleneck_v1/shortcut/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x256x128) [32768, bytes: 131072]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x128x128) [147456, bytes: 589824]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x128x512) [65536, bytes: 262144]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_1/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x512x128) [65536, bytes: 262144]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x128x128) [147456, bytes: 589824]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x128x512) [65536, bytes: 262144]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_2/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x512x128) [65536, bytes: 262144]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x128x128) [147456, bytes: 589824]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x128x512) [65536, bytes: 262144]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_3/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x512x128) [65536, bytes: 262144]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x128x128) [147456, bytes: 589824]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 128) [128, bytes: 512]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x128x512) [65536, bytes: 262144]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block2/unit_4/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block3/unit_1/bottleneck_v1/shortcut/weights:0 (float32_ref 1x1x512x1024) [524288, bytes: 2097152]
resnet_v1_50/block3/unit_1/bottleneck_v1/shortcut/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_1/bottleneck_v1/shortcut/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x512x256) [131072, bytes: 524288]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_1/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x256) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_2/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x256) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_3/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x256) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_4/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x256) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_5/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x256) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x256x256) [589824, bytes: 2359296]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 256) [256, bytes: 1024]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x256x1024) [262144, bytes: 1048576]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block3/unit_6/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 1024) [1024, bytes: 4096]
resnet_v1_50/block4/unit_1/bottleneck_v1/shortcut/weights:0 (float32_ref 1x1x1024x2048) [2097152, bytes: 8388608]
resnet_v1_50/block4/unit_1/bottleneck_v1/shortcut/BatchNorm/gamma:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_1/bottleneck_v1/shortcut/BatchNorm/beta:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x1024x512) [524288, bytes: 2097152]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x512x512) [2359296, bytes: 9437184]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x512x2048) [1048576, bytes: 4194304]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_1/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x2048x512) [1048576, bytes: 4194304]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x512x512) [2359296, bytes: 9437184]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x512x2048) [1048576, bytes: 4194304]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_2/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv1/weights:0 (float32_ref 1x1x2048x512) [1048576, bytes: 4194304]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv1/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv1/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/weights:0 (float32_ref 3x3x512x512) [2359296, bytes: 9437184]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/BatchNorm/gamma:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv2/BatchNorm/beta:0 (float32_ref 512) [512, bytes: 2048]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/weights:0 (float32_ref 1x1x512x2048) [1048576, bytes: 4194304]WARNING:tensorflow:From /home/mist/tf-code/ResNet/ResNet.py:298: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From /home/mist/tf-code/ResNet/ResNet.py:300: The name tf.train.Saver is deprecated. Please use tf.compat.v1.train.Saver instead.

2021-04-22 02:22:37.637344: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2021-04-22 02:22:37.884519: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7

resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/BatchNorm/gamma:0 (float32_ref 2048) [2048, bytes: 8192]
resnet_v1_50/block4/unit_3/bottleneck_v1/conv3/BatchNorm/beta:0 (float32_ref 2048) [2048, bytes: 8192]
Logits/fc/weights:0 (float32_ref 2048x4) [8192, bytes: 32768]
Logits/fc/biases:0 (float32_ref 4) [4, bytes: 16]
Total size of variables: 23516228
Total bytes of variables: 94064912
test_accuracy: 0.46,  test_top_k_acc: 0.60
 [*] Test finished!
